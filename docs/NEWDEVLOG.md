# 🛠️ 개발 현황 (DevLog)

**마지막 업데이트**: 2025-03-25

## 📌 개요

산업 안전 종합 관리 플랫폼의 개발 현황을 기록하는 문서입니다. 현재까지 완료된 작업과 진행 중인 작업, 그리고 앞으로의 계획을 포함합니다. 본 문서에는 백엔드 개발 현황과 새롭게 전환된 KRDS HTML Component Kit 기반 프론트엔드 개발 현황이 모두 포함되어 있습니다.

## ✅ 완료된 작업

### 1. 프로젝트 초기 설정 및 환경 구축 (1단계)

#### 기술 스택 설정
- **프론트엔드**: 
  - ~~Next.js 설치 및 기본 구조 설정~~ (KRDS HTML Component Kit으로 전환)
  - ~~Tailwind CSS 설정~~ (SCSS로 전환)
  - ~~Chakra UI 설치 및 초기 설정~~ (KRDS 컴포넌트로 전환)
  - 기본 페이지 구조 생성
  - **신규**: Vite 기반 개발환경 구축
  - **신규**: SCSS 스타일 시스템 구현
  - **신규**: KRDS HTML Component Kit 통합

- **백엔드**: 
  - NestJS 프로젝트 생성
  - 필요한 의존성 설치 (Prisma, Swagger, 기타 유틸리티)
  - 기본 모듈 구조 설정 

- **데이터베이스**: 
  - Docker Compose를 사용한 PostgreSQL 컨테이너 설정
  - pgAdmin 설정

#### 관련 문서
- README.md - 프로젝트 개요 및 설정 가이드
- docs/TECH_STACK.md - 기술 스택 상세 명세
- docs/KRDS_MIGRATION.md - KRDS 마이그레이션 가이드

### 2. 데이터베이스 설계 및 Prisma 스키마 작성 (2단계)

#### 데이터베이스 스키마 설계
- Prisma 스키마 작성 (prisma/schema.prisma)
  - 사용자 모델 (User)
  - 프로젝트 모델 (Project, ProjectMember)
  - 위험성 평가 모델 (RiskAssessment, RiskFactor)
  - 안전 문서 모델 (SafetyDocument, DocumentAccess)
  - 근로자 관리 모델 (Worker, WorkerEducation, WorkerCheckin)
  - 기타 보조 모델 (ChatMessage, Notification, CommunityPost, Comment)

#### 데이터베이스 초기화 및 시드 데이터
- 마이그레이션 실행 (`npx prisma migrate dev`)
- 시드 스크립트 작성 및 실행 
  - 테스트 사용자 생성 (관리자, 일반 사용자)
  - 테스트 프로젝트 생성
  - 위험성 평가 샘플 데이터 생성

#### 데이터베이스 관련 문서화
- docs/PRISMA_STUDIO.md - Prisma Studio 사용 가이드
- docs/DATABASE_SECURITY.md - 데이터베이스 보안 전략
- docs/MIGRATION_STRATEGY.md - 마이그레이션 전략

### 3. API 설계 및 구현 (3단계 - 완료)

#### 구현된 API
- **인증 API**
  - 회원가입, 로그인, 비밀번호 재설정
  - JWT 기반 인증 시스템 구현
  
- **프로젝트 관리 API**
  - 프로젝트 CRUD 기능
  - 프로젝트 멤버 관리 (추가, 역할 변경, 제거)
  - 사용자 권한 기반 접근 제어
  - 프로젝트 통계 조회 기능 추가 (위험성 평가, 안전 문서, 근로자 등의 통계)
  - 프로젝트 활동 내역 조회 기능 추가 (최근 위험성 평가, 문서 업로드, 멤버 변경 등)
  
- **위험성 평가 API**
  - 위험성 평가 CRUD 기능
  - 위험 요소 관리
  - 사용자 권한 검증
  - 위험성 평가 PDF 내보내기 기능 추가
  
- **AI 챗봇 API**
  - OpenAI API 연동
  - 사용자 메시지 및 AI 응답 처리
  - 채팅 이력 조회 기능
  - 응답에 대한 피드백 제공 기능

- **안전 문서 관리 API**
  - 문서 CRUD 기능
  - 문서 접근 권한 관리 (권한 부여 및 제거)
  - 문서 필터링 및 검색 기능
  - 문서 유효기간 관리

- **근로자 관리 API**
  - 근로자 등록 및 관리 (CRUD 기능)
  - 교육 이력 관리
  - 출입 기록 관리 (체크인/체크아웃)
  - 권한 기반 접근 제어

- **통계 API**
  - 프로젝트별 위험성 평가 통계
  - 근로자 출입 통계
  - AI 챗봇 사용 통계

- **알림 API**
  - 알림 생성, 조회, 삭제 기능
  - 알림 읽음 상태 관리 (단일 알림 및 전체 알림)
  - 다양한 알림 유형 지원 (프로젝트 초대, 위험성 평가, 문서 공유 등)

- **커뮤니티 API**
  - 게시글 CRUD 기능
  - 댓글 작성 및 삭제 기능
  - 프로젝트 연결 및 권한 기반 접근 제어
  - 게시글 검색 및 필터링
  - 성능 최적화 적용 (트랜잭션, 병렬 처리, 로깅)

#### API 문서화
- Swagger UI를 통한 API 문서 자동화
- API 응답 형식 표준화
- DTO를 통한 입력 검증 체계 구현

### 4. 프론트엔드 개발 환경 구축 (완료)

#### 프론트엔드 환경 전환
- Next.js에서 KRDS HTML Component Kit 기반으로 전환
- Vite 빌드 시스템 구축 완료
- SCSS 스타일 시스템 구현 완료
- 프로젝트 디렉토리 구조 설정
  - src/assets/ - 이미지, 폰트 등 정적 리소스
  - src/components/ - 재사용 가능한 UI 컴포넌트
  - src/js/ - JavaScript 모듈
  - src/layouts/ - 페이지 레이아웃 템플릿
  - src/pages/ - 각 페이지 HTML
  - src/styles/ - SCSS 스타일시트

#### 핵심 모듈 구현
- **코어 JavaScript 모듈**:
  - api.js - Axios 기반 API 클라이언트 구현
  - auth.js - 인증 관련 기능 구현 (로그인, 로그아웃, 토큰 관리)
  - main.js - 앱 초기화 및 공통 기능 구현
  - utils.js - 유틸리티 함수 모음 구현

#### 기본 컴포넌트 구현
- 알림 시스템 구현
- 공통 UI 구성요소 (버튼, 폼 요소) 구현

### 5. 주요 페이지 및 기능 구현 (일부 완료)

#### 인증 시스템
- **로그인 페이지 구현 완료**
  - KRDS 스타일 적용
  - 로그인 폼 및 유효성 검사 구현
  - 오류 메시지 표시 기능
  - 로그인 상태 유지 기능

- **회원가입 페이지 구현 완료**
  - 사용자 정보 입력 폼 구현
  - 이용약관 동의 체크박스
  - 입력 데이터 유효성 검사

#### 레이아웃 및 공통 컴포넌트
- **메인 레이아웃 템플릿 완성**
  - 헤더 컴포넌트 구현
  - 푸터 컴포넌트 구현
  - 사이드 네비게이션 구현
  - 페이지 콘텐츠 영역 설계

#### 대시보드 페이지
- **통계 요약 카드 구현 완료**
  - 프로젝트, 위험성 평가, 문서, 근로자 통계 표시
  - 반응형 그리드 레이아웃
- **최근 활동 타임라인 구현 완료**
  - 아이콘 기반 활동 유형 표시
  - 타임스탬프 및 활동 내용 표시
  - 타입별 색상 구분

#### JavaScript 모듈 확장
- **대시보드 모듈 구현**
  - 통계 데이터 가져오기 함수 구현
  - 최근 활동 데이터 가져오기 함수 구현
  - 임시 데이터 생성 기능 (API 연동 전)

## 🔄 진행 중인 작업

### 백엔드 진행 작업
- Prisma Studio를 통한 데이터 모델 검증 및 관계 확인
- 시드 데이터 검증 및 보완
- 개발 문서 보완 및 업데이트
- **API 성능 최적화 및 안정화**
  - 대용량 데이터 처리 최적화
  - 에러 처리 강화
  - API 테스트 케이스 작성
  - 위험성 평가 서비스 성능 최적화 진행 중

### 프론트엔드 진행 작업
- **프로젝트 관련 페이지 구현 중**
  - 프로젝트 목록 페이지 레이아웃 설계 중
  - 프로젝트 상세 페이지 컴포넌트 구성 중
  - 프로젝트 생성/수정 폼 설계 중

- **위험성 평가 관련 페이지 계획**
  - 위험성 평가 목록 페이지 구조 설계 중
  - 위험성 평가 상세 페이지 레이아웃 계획
  - 위험성 평가 작성 폼 계획

- **KRDS 스타일 시스템 확장**
  - 디자인 토큰 시스템 구현 계획
  - 추가 컴포넌트 스타일 개발 중
  - 디자인 토큰 JSON 파일 구성 계획

- **오류 수정 및 안정화**
  - 불필요한 import 오류 수정 완료 (style.css, 디자인 토큰 JSON 파일)
  - 빌드 오류 해결 및 안정화 작업 진행

## 📝 프론트엔드 개발 계획

### 1. 페이지 구성 계획

#### 인증 관련 페이지
- **로그인 페이지** - `/login.html` ✅
- **회원가입 페이지** - `/signup.html` ✅
- **비밀번호 재설정 요청 페이지** - `/forgot-password.html`
- **비밀번호 재설정 페이지** - `/reset-password.html`

#### 메인 페이지
- **대시보드** - `/index.html` (인증된 사용자의 홈) ✅

#### 프로젝트 관련 페이지
- **프로젝트 목록** - `/projects/index.html`
- **프로젝트 상세** - `/projects/detail.html`
- **프로젝트 생성/수정** - `/projects/edit.html`
- **프로젝트 멤버 관리** - `/projects/members.html`

#### 위험성 평가 관련 페이지
- **위험성 평가 목록** - `/risk-assessments/index.html`
- **위험성 평가 상세** - `/risk-assessments/detail.html`
- **위험성 평가 생성/수정** - `/risk-assessments/edit.html`

#### 안전 문서 관련 페이지
- **문서 목록** - `/safety-docs/index.html`
- **문서 상세/다운로드** - `/safety-docs/detail.html`
- **문서 업로드/수정** - `/safety-docs/edit.html`

#### 근로자 관리 관련 페이지
- **근로자 목록** - `/workers/index.html`
- **근로자 상세** - `/workers/detail.html`
- **근로자 추가/수정** - `/workers/edit.html`
- **근로자 출입 기록** - `/workers/checkin.html`
- **근로자 교육 관리** - `/workers/education.html`

#### 커뮤니티 관련 페이지
- **게시글 목록** - `/community/index.html`
- **게시글 상세** - `/community/detail.html`
- **게시글 작성/수정** - `/community/edit.html`

#### AI 챗봇 페이지
- **챗봇 인터페이스** - `/chatbot.html`

### 2. 구현 우선순위 및 일정

#### 단계 1: 기본 구조 및 인증 (완료)
- ✅ 기본 레이아웃 구현 (헤더, 사이드바, 푸터)
- ✅ 인증 관련 페이지 구현 (로그인, 회원가입)
- ✅ 코어 JavaScript 모듈 구현 (api.js, auth.js, main.js)
- ✅ 대시보드 페이지 기본 구현

#### 단계 2: 프로젝트 및 대시보드 세부 기능 (진행 중)
- ✅ 대시보드 통계 카드 구현
- ✅ 대시보드 최근 활동 타임라인 구현
- 🔄 프로젝트 관련 페이지 구현
- 🔄 프로젝트 관련 JavaScript 모듈 구현

#### 단계 3: 위험성 평가 및 안전 문서 (예정)
- 위험성 평가 관련 페이지 구현
- 안전 문서 관련 페이지 구현
- 관련 JavaScript 모듈 구현

#### 단계 4: 근로자 관리 및 커뮤니티 (예정)
- 근로자 관리 관련 페이지 구현
- 커뮤니티 관련 페이지 구현
- 관련 JavaScript 모듈 구현

#### 단계 5: AI 챗봇 및 알림 (예정)
- 챗봇 인터페이스 구현
- 알림 시스템 구현
- 관련 JavaScript 모듈 구현

#### 단계 6: 테스트 및 최적화 (예정)
- 크로스 브라우저 테스트
- 반응형 디자인 최적화
- 성능 최적화
- 버그 수정

## 📊 전체 진행 상황 요약

| 단계 | 완료율 | 비고 |
|------|--------|------|
| 요구사항 분석 | 100% | 모든 요구사항 정의 완료 |
| 데이터베이스 설계 | 95% | 대부분의 테이블 설계 완료, 일부 수정 필요 |
| API 설계 및 구현 | 100% | 모든 주요 API 구현 완료 |
| 프론트엔드 개발 환경 전환 | 100% | Next.js에서 KRDS 기반으로 전환 완료 |
| 프론트엔드 기본 구조 구현 | 60% | 기본 레이아웃, 코어 모듈 구현 중 |
| 프론트엔드 페이지 구현 | 15% | 인증 페이지 구현 진행 중 |
| 테스트 | 30% | 단위 테스트 일부 작성 |
| 문서화 | 75% | API 문서 작성 완료, 프론트엔드 문서 작성 중 |
| 배포 및 운영 | 10% | 초기 배포 환경 구성 중 |
| 성능 최적화 | 30% | 백엔드 일부 최적화 완료, 프론트엔드 최적화 예정 |

## 🚧 이슈 및 해결해야 할 과제

### 백엔드 이슈
- **OpenAI API 호출 비용 관리 전략 수립 필요**
- **대용량 파일 업로드 처리 방안 설계 필요**
- **AI 챗봇 응답 캐싱 전략 필요**
- **PDF 내보내기 기능**
  - PDF 생성 시 한글 폰트 지원 필요
  - 위험 요소 테이블 레이아웃 개선 필요
  - 템플릿 기반 PDF 생성 시스템 구현 검토

### 프론트엔드 이슈
- **KRDS 컴포넌트 적응 및 활용**
  - KRDS 컴포넌트 사용법 숙지 중
  - 컴포넌트 커스터마이징 방법 연구 중
- **레이아웃 반응형 구현**
  - 모바일 레이아웃 최적화 방안 연구 중
- **JavaScript 모듈 구조화**
  - 모듈 간 의존성 관리 방안 구축 중
- **API 연동 테스트**
  - 백엔드 API와의 연동 테스트 진행 중

### 해결된 이슈
- **린터 에러 해결**
  - Prisma 스키마 변경 시 필드가 타입에 반영되지 않는 문제
  - 해결 방안: `npx prisma generate` 명령어 실행 및 애플리케이션 빌드를 통해 해결
  - OpenAI API 응답 타입 관련 문제 해결 완료
  - 커뮤니티 서비스 린터 오류 해결 (Prisma 타입 관련 문제)
  - 통계 서비스의 raw query 타입 캐스팅을 통한 타입 오류 해결
- **프론트엔드 환경 전환**
  - Next.js, Chakra UI, Tailwind CSS에서 KRDS HTML Component Kit로 전환 완료
  - Vite 빌드 시스템 구축 완료
  - SCSS 스타일 시스템 구현 완료

## 💡 향후 개선 계획

### 기능 개선 계획
1. **실시간 알림 시스템**
   - 웹소켓 연동
   - 브라우저 푸시 알림 구현
   - 이메일 알림 시스템

2. **고급 분석 및 보고서**
   - 안전 지표 대시보드
   - 커스텀 보고서 생성
   - 데이터 시각화 강화

3. **모바일 대응**
   - 반응형 디자인 최적화
   - 모바일 앱 검토 (React Native)

### 프론트엔드 개선 계획
1. **컴포넌트 라이브러리 확장**
   - KRDS 기반 커스텀 컴포넌트 개발
   - 재사용 가능한 UI 패턴 구축

2. **성능 최적화**
   - 코드 분할 및 지연 로딩 적용
   - 이미지 최적화
   - 캐싱 전략 구현

3. **사용자 경험 개선**
   - 애니메이션 및 전환 효과 추가
   - 피드백 메커니즘 강화
   - 접근성 개선

## 🎯 다음 주 목표

1. **프론트엔드 개발**
   - 로그인/회원가입 페이지 구현 완료
   - 메인 대시보드 레이아웃 구현 완료
   - 프로젝트 목록 페이지 구현 시작
   - 헤더 및 사이드바 컴포넌트 완성

2. **백엔드 개발**
   - 나머지 서비스 성능 최적화 진행 (위험성 평가, 프로젝트 관리)
   - API 테스트 케이스 추가 작성
   - OpenAI API 연동 최적화

3. **문서화**
   - 프론트엔드 컴포넌트 문서화
   - API 연동 가이드 작성
   - 개발 문서 업데이트

4. **프로젝트 관리**
   - 개발 일정 조정 및 우선순위 재설정
   - 팀 내 코드 리뷰 프로세스 강화 